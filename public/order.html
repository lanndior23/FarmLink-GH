<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FarmLink GH ‚Äì Order Crops</title>
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="firebase/config.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      background: #f2f9f2;
    }
    h2 {
      text-align: center;
      color: #007b5e;
    }
    .crop-card {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 16px;
      margin: 10px 0;
      background: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .order-btn {
      background: #007b5e;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>üõí Order Available Crops</h2>
  <div id="cropList"></div>

  <script>
    const crops = [
      "Maize", "Rice", "Millet", "Sorghum", "Cassava", "Yam", "Cocoyam",
      "Sweet Potato", "Plantain", "Banana", "Mango", "Pineapple", "Papaya",
      "Orange", "Watermelon", "Avocado", "Coconut", "Tomatoes", "Garden Eggs",
      "Okra", "Pepper", "Cabbage", "Carrots", "Onion", "Lettuce", "Cucumber",
      "Groundnut", "Cowpea", "Soybean", "Cocoa", "Oil Palm", "Coffee", "Cotton",
      "Rubber", "Shea Nuts", "Ginger", "Garlic", "Turmeric", "Basil", "Mint"
    ];

    const cropList = document.getElementById('cropList');

    crops.forEach(crop => {
      const card = document.createElement('div');
      card.className = 'crop-card';
      card.innerHTML = `
        <strong>${crop}</strong>
        <button class="order-btn" onclick="placeOrder('${crop}')">Order Now</button>
      `;
      cropList.appendChild(card);
    });

    function placeOrder(cropName) {
      firebase.auth().onAuthStateChanged(user => {
        if (user) {
          const buyerId = user.uid;
          const buyerName = user.displayName || user.email || "Anonymous";

          firebase.firestore().collection("orders").add({
            cropName: cropName,
            buyerName: buyerName,
            buyerId: buyerId,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          }).then(() => {
            alert(`‚úÖ Order for ${cropName} placed successfully!`);
          }).catch(error => {
            console.error("‚ùå Firestore error:", error);
            alert("‚ùå Error placing order.");
          });

        } else {
          alert("‚ö†Ô∏è Please log in first to place an order.");
        }
      });
    }
  </script>
</body>
</html>
